<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URBANO. | QUIZ. </title>
    <link rel="stylesheet" href="./styles/quiz.css">

    <!-- Fontes utilizadas -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Urbanist:ital,wght@0,100..900;1,100..900&display=swap"
    rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One&display=swap" rel="stylesheet" />
</head>


<body onload="onloadEsconder()">

    <div class="header">
        <div class="container">
            <div class="logo">
                <a href="index.html"><img width="315" height="93" src="./assets/logo_alt2.png" alt="logo do site" /></a>
                <p class="subtitle">
                    COOL KIDS DISCOVER <br />
                    THEMSELVES.
                </p>
            </div>
            <div class="links-header">
                <nav class="nav-bar">
                    <input type="checkbox" id="burger" onchange="burger_menu()">
                    <label class="burger" for="burger">
                        <span></span>
                        <span></span>
                        <span></span>
                    </label>
                    <div class="offscreenmenu">
                        <ul>
                            <li><a class="menu_item" href="./dashboard.html">DASHBOARD</a></li>
                            <li><a class="menu_item" href="./index.html">SAIR</a></li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
    <div id="startQuiz" class="container-quiz">
        <button id="btnIniciarQuiz" class="button-quiz" onclick="iniciarQuiz()">INICIAR QUIZ</button>

        <div id="pontuacao" class="flex-colunar width-fit-content border-primary">
            <div id="finalStyleScore" class="flex-colunar padding-8">
                <span class="final-text" style="font-size: 20px;">
                    Seu estilo predominante é: <br>
                    <span id="spanPontuacaoFinal" style="font-weight: bold; font-size: 50px;">***</span>
                </span>
                <span id="msgFinal" class="width-fit-content">***</span>
            </div>
        </div>

        <div id="jogo" class="width-fit-content flex-colunar border-secondary">

            <div id="infoQuestao" class="padding-8">
                <span>QUESTÃO ATUAL: <span id="ActualQuestionNumberSpan"></span> DE <span id="qtdQuestoes"></span>
                    QUESTÕES.</span class="title">
            </div>

            <div id="perguntaDaQuestaoAtual" class="padding-8">
                <span id="spanQuestaoExibida" class="text-bold"></span>
            </div>

            <div id="infoAlternativas" class="padding-8">
                <span><em>ESCOLHA A OPÇÃO QUE MAIS TE REPRESENTE:</em></span>
            </div>

            <div id="opcoes" class="flex-colunar padding-8">
                <span>
                    <input type="radio" id="primeiraOpcao" name="option" class="radio" value="alternativaA" />
                    <label for="primeiraOpcao" class="option" id="labelOpcaoUm"></label>
                </span>
                <span>
                    <input type="radio" id="segundaOpcao" name="option" class="radio" value="alternativaB" />
                    <label for="segundaOpcao" class="option" id="labelOpcaoDois"></label>
                </span>
                <span>
                    <input type="radio" id="terceiraOpcao" name="option" class="radio" value="alternativaC" />
                    <label for="terceiraOpcao" class="option" id="labelOpcaoTres"></label>
                </span>
                <span>
                    <input type="radio" id="quartaOpcao" name="option" class="radio" value="alternativaD" />
                    <label for="quartaOpcao" class="option" id="labelOpcaoQuatro"></label>
                </span>
                <span>
                    <input type="radio" id="quintaOpcao" name="option" class="radio" value="alternativaE" />
                    <label for="quintaOpcao" class="option" id="labelOpcaoCinco"></label>
                </span>
            </div>

            <div id="botoes" class="flex-colunar padding-8 buttons">
                <button onclick="submit()" id="btnSubmit" class="button">CONFIRMAR RESPOSTA</button>
                <button onclick="avancar()" id="btnProx" disabled class="button">AVANÇAR</button>
                <button onclick="tentarNovamente()" id="btnTentarNovamente" disabled class="button">TENTAR NOVAMENTE</button>
            </div>

        </div>
    </div>
</body>

</html>
<script>
    console.log("Verificando sessão...");
    console.log("ID_USUARIO:", sessionStorage.ID_USUARIO);
    console.log("NOME_USUARIO:", sessionStorage.NOME_USUARIO);

    if (!sessionStorage.ID_USUARIO) {
        alert("Você precisa estar logado para fazer o quiz!");
        window.location.href = "./login.html";
    }

    var listaDeQuestoes = [

        {
            pergunta: "1. O QUE É INDISPENSÁVEL EM UMA PEÇA DE ROUPA PARA VOCÊ?",
            alternativaA: "CONFORTO ABSOLUTO E PRATICIDADE.",
            alternativaB: "QUALIDADE IMPECÁVEL, DURABILIDADE E BOM ACABAMENTO.",
            alternativaC: "SUAVIDADE, LEVEZA E DETALHES DELICADOS.",
            alternativaD: "IMPACTO VISUAL, FORÇA E UM CORTE QUE TRANSMITA CONFIANÇA",
            alternativaE: "ORIGINALIDADE; ALGO QUE REPRESENTE O MEU MOOD DO DIA."
        },

        {
            pergunta: "2. QUAL PALETA DE CORES DOMINA O SEU GUARDA-ROUPA?",
            alternativaA: "CORES NEUTRAS E NATURAIS (BRANCO, CINZA, BEGE, AZUL-MARINHO).",
            alternativaB: "CORES SÓBRIAS, DISCRETAS E FECHADAS.",
            alternativaC: "TONS PASTÉIS E CORES CLARAS/SUAVES.",
            alternativaD: "CORES INTENSAS, FORTES E CONTRASTANTES.",
            alternativaE: "UMA MISTURA LIVRE DE CORES VIBRANTES E COMBINAÇÕES INUSITADAS."
        },

        {
            pergunta: "3. QUANDO O ASSUNTO É SAPATOS, O QUE VOCÊ ESCOLHE PARA O DIA A DIA?",
            alternativaA: "TÊNIS, CALÇADOS PLANOS E ANATÔMICOS.",
            alternativaB: "MOCASSINS, SAPATOS CLÁSSICOS DE COURO OU BICO FECHADO.",
            alternativaC: "SAPATILHAS DELICADAS OU MODELOS DISCRETOS.",
            alternativaD: "BOTAS DE VERNIZ, SAPATOS DE DESIGN ARROJADO OU SALTOS IMPONENTES.",
            alternativaE: "SAPATOS COM DESIGNS ARTÍSTICOS, COLORIDOS OU COM FORMATOS DIFERENTES."
        },

        {
            pergunta: "4. COMO VOCÊ LIDA COM O SEU CABELO E CUIDADOS COM O ROSTO?",
            alternativaA: "PRATICIDADE TOTAL: VISUAL NATURAL E FÁCIL DE MANTER.",
            alternativaB: "IMPECÁVEL: SEMPRE ALINHADO E COM CORTE EM DIA.",
            alternativaC: "SUAVE: VISUAL LEVE E COM MOVIMENTO NATURAL.",
            alternativaD: "MARCANTE: CORTES MODERNOS OU VISUAL DE IMPACTO.",
            alternativaE: "ORIGINAL: GOSTO DE MUDAR, USAR CORES OU ACESSÓRIOS."
        },

        {
            pergunta: "5. QUAL DESTES ACESSÓRIOS OU COMPLEMENTOS NÃO PODE FALTAR?",
            alternativaA: "MOCHILA FUNCIONAL, SMARTWATCH OU ITENS PRÁTICOS.",
            alternativaB: "RELÓGIO CLÁSSICO, CINTO DE COURO OU ITENS DE MARCA DISCRETA.",
            alternativaC: "ACESSÓRIOS SUTIS, COM SIGNIFICADO PESSOAL OU DESIGN LEVE.",
            alternativaD: "ÓCULOS GRANDES, METAIS PESADOS OU ITENS QUE CHAMEM ATENÇÃO.",
            alternativaE: "PEÇAS ARTESANAIS, VINTAGE OU COM DESIGN ARTÍSTICO."
        },

        {
            pergunta: "6. SE VOCÊ FOSSE CONVIDADO PARA UM EVENTO SOCIAL IMPORTANTE, O QUE VESTIRIA?",
            alternativaA: "ALGO QUE NÃO ME APERTE E ME DEIXE À VONTADE.",
            alternativaB: "ALFAIATARIA IMPECÁVEL (TERNO OU BLAZER) BEM CORTADA E ALINHADA.",
            alternativaC: "TECIDOS LEVES, CORES SUAVES E CAIMENTO FLUIDO.",
            alternativaD: "VISUAL ESTRUTURADO, CORES ESCURAS OU CORTES MODERNOS DE IMPACTO.",
            alternativaE: "UMA COMBINAÇÃO OUSADA DE PEÇAS OU UM DESIGN INOVADOR."
        },

        {
            pergunta: "7. O QUE VOCÊ PREFERE EM RELAÇÃO A ESTAMPAS E TEXTURAS?",
            alternativaA: "PREFIRO LISOS OU LISTRAS SIMPLES E CASUAIS.",
            alternativaB: "GOSTO DAS CLÁSSICAS: XADREZ DISCRETO OU RISCA DE GIZ.",
            alternativaC: "ESTAMPAS PEQUENAS, DISCRETAS OU TEXTURAS SUAVES AO TOQUE.",
            alternativaD: "ALTO CONTRASTE, FORMAS GEOMÉTRICAS GRANDES OU TEXTURAS MARCANTES.",
            alternativaE: "MIX DE ESTAMPAS, GRÁFICOS ARTÍSTICOS OU ÉTNICOS."
        },

        {
            pergunta: "8. QUAL MENSAGEM VOCÊ QUER PASSAR COM SUA IMAGEM?",
            alternativaA: "SOU ACESSÍVEL, DESCOMPLICADO E LEVE.",
            alternativaB: "SOU PROFISSIONAL, CONFIÁVEL E SÉRIO.",
            alternativaC: "SOU EMPÁTICO, CALMO E ACOLHEDOR.",
            alternativaD: "SOU FORTE, INTENSO E AUTOCONFIANTE.",
            alternativaE: "SOU CRIATIVO, LIVRE E TENHO PERSONALIDADE ÚNICA."
        },

        {
            pergunta: "9. O QUE MAIS TE INCOMODA EM UM VISUAL?",
            alternativaA: "ROUPAS APERTADAS, TECIDOS RÍGIDOS OU QUE PINICAM.",
            alternativaB: "PARECER DESLEIXADO OU USAR ALGO COM ACABAMENTO RUIM.",
            alternativaC: "VISUAIS MUITO AGRESSIVOS, PESADOS OU FRIOS.",
            alternativaD: "PASSAR DESPERCEBIDO OU PARECER SEM SAL NA MULTIDÃO.",
            alternativaE: "ESTAR VESTIDO IGUAL A TODO MUNDO (UNIFORMIZADO)."
        },

        {
            pergunta: "10. O QUE DEFINE SUA DECISÃO DE COMPRA?",
            alternativaA: "FUNCIONALIDADE: SERVE PARA VÁRIAS COISAS E É CONFORTÁVEL?",
            alternativaB: "CUSTO-BENEFÍCIO: É UMA PEÇA DURÁVEL QUE VALE O INVESTIMENTO?",
            alternativaC: "CONEXÃO: A PEÇA ME TRAZ UMA SENSAÇÃO BOA E ACOLHEDORA?",
            alternativaD: "PODER: A PEÇA ME FAZ SENTIR MAIS CONFIANTE E FORTE?",
            alternativaE: "EXCLUSIVIDADE: É ALGO DIFERENTE QUE NINGUÉM TEM IGUAL?"
        }
    ]

    // variáveis globais    
    var actualQuestionNumber = 0
    var quantidadeDeQuestoes = listaDeQuestoes.length

    var pontuacao = {
        "Esportivo": 0,
        "Elegante": 0,
        "Tradicional": 0,
        "Romantico": 0,
        "SEXY": 0,
        "Criativo": 0,
        "Dramatico": 0
    }

    function onloadEsconder() {
        document.getElementById('pontuacao').style.display = "none";
        document.getElementById('jogo').style.display = "none";
    }

    function iniciarQuiz() {
        document.getElementById('pontuacao').style.display = "flex";
        document.getElementById('jogo').style.display = "flex";
        document.getElementById('btnIniciarQuiz').style.display = "none";
        document.getElementById('finalStyleScore').style.display = "none";

        document.getElementById('qtdQuestoes').innerHTML = quantidadeDeQuestoes;

        preencherHTMLcomQuestaoAtual(0);

        btnSubmit.disabled = false;
        btnProx.disabled = true;
        btnTentarNovamente.disabled = true;
    }

    function preencherHTMLcomQuestaoAtual(index) {
        habilitarAlternativas(true);
        var questaoAtual = listaDeQuestoes[index];
        actualQuestionNumber = index;

        document.getElementById("ActualQuestionNumberSpan").innerHTML = Number(index) + 1
        document.getElementById("spanQuestaoExibida").innerHTML = questaoAtual.pergunta;

        document.getElementById("labelOpcaoUm").innerHTML = questaoAtual.alternativaA;
        document.getElementById("labelOpcaoDois").innerHTML = questaoAtual.alternativaB;
        document.getElementById("labelOpcaoTres").innerHTML = questaoAtual.alternativaC;
        document.getElementById("labelOpcaoQuatro").innerHTML = questaoAtual.alternativaD;
        document.getElementById("labelOpcaoCinco").innerHTML = questaoAtual.alternativaE;

    }

    function submit() {
        var options = document.getElementsByName("option");
        var hasChecked = false

        for (var i = 0; i < options.length; i++) {
            if (options[i].checked) {
                hasChecked = true
                break
            }
        }

        if (!hasChecked) {
            alert("Não há alternativas escolhidas. Escolha uma opção.")
        } else {
            btnSubmit.disabled = true
            btnProx.disabled = false

            habilitarAlternativas(false)

            sumPoints()
        }
    }

    function habilitarAlternativas(trueOrFalse) {
        var selectedOption = trueOrFalse ? false : true;
        document.getElementById('primeiraOpcao').disabled = selectedOption;
        document.getElementById('segundaOpcao').disabled = selectedOption;
        document.getElementById('terceiraOpcao').disabled = selectedOption;
        document.getElementById('quartaOpcao').disabled = selectedOption;
        document.getElementById('quintaOpcao').disabled = selectedOption;
    }

    function avancar() {
        btnProx.disabled = true
        btnSubmit.disabled = false

        desmarcarRadioButtons()

        if (actualQuestionNumber < quantidadeDeQuestoes - 1) {
            preencherHTMLcomQuestaoAtual(actualQuestionNumber + 1)
        } else {
            finalizarJogo()
        }
    }

    function tentarNovamente() {
        window.location.reload()
    }

    function sumPoints() {
        var options = document.getElementsByName("option");

        var valorEscolhido = ""

        for (var option of options) {
            if (option.checked) {
                valorEscolhido = option.value;
            }
        }

        if (valorEscolhido === "alternativaA") {
            pontuacao.Esportivo += 2;
            pontuacao.Criativo += 1;
        } else if (valorEscolhido === "alternativaB") {
            pontuacao.Tradicional += 2;
            pontuacao.Elegante += 1;
        } else if (valorEscolhido === "alternativaC") {
            pontuacao.Romantico += 2;
            pontuacao.Elegante += 1;
        } else if (valorEscolhido === "alternativaD") {
            pontuacao.Sexy += 2;
            pontuacao.Dramatico += 1;
        } else if (valorEscolhido === "alternativaE") {
            pontuacao.Criativo += 2;
            pontuacao.Dramatico += 1;
        }
    }

    function desmarcarRadioButtons() {
        var options = document.getElementsByName("option");
        for (var i = 0; i < options.length; i++) {
            options[i].checked = false;
        }
    }

    function finalizarJogo() {
        document.getElementById('jogo').style.display = "none";
        document.getElementById('finalStyleScore').style.display = "flex";

        var estiloVencedor = "";
        var maiorPontuacao = -1;

        for (var estilo in pontuacao) {
            if (pontuacao[estilo] > maiorPontuacao) {
                maiorPontuacao = pontuacao[estilo];
                estiloVencedor = estilo;
            }
        }

        document.getElementById('spanPontuacaoFinal').innerHTML = estiloVencedor
        document.getElementById('msgFinal').innerHTML = `<span>ESSE ESTILO COMBINA COM SUA PERSONALIDADE!</span>`;
        document.getElementById('btnTentarNovamente').disabled = false

        saveResults(estiloVencedor);
    }

    function saveResults(estiloTexto) {
        var yourStyle = {
            "Esportivo": 1000,
            "Tradicional": 1001,
            "Elegante": 1002,
            "Romantico": 1003,
            "Sexy": 1004,
            "Criativo": 1005,
            "Dramatico": 1006
        };

        var idUsuario = sessionStorage.ID_USUARIO;
        var idEstilo = yourStyle[estiloTexto];

        console.log("=== DEBUG SAVE RESULTS ===");
        console.log("Estilo texto:", estiloTexto);
        console.log("ID Usuario (sessionStorage):", idUsuario);
        console.log("ID Estilo (mapeado):", idEstilo);
        console.log("Objeto que será enviado:", {
            idUsuarioServer: idUsuario,
            idEstiloServer: idEstilo
        });

        if (idUsuario && idEstilo) {
            fetch("/quiz/register", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    idUsuarioServer: idUsuario,
                    idEstiloServer: idEstilo
                })
            }).then(resposta => {
                if (resposta.ok) {
                    console.log("Salvo no banco com sucesso!");
                }
            }).catch(erro => {
                console.error("Erro no fetch:", erro);
            });
        } else {
            console.error("ERRO: Dados inválidos!");
            console.error("idUsuario:", idUsuario, "- idEstilo:", idEstilo);
        }
    };
</script>